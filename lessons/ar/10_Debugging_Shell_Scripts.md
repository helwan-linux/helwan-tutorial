تصحيح أخطاء نصوص Shell
تصحيح الأخطاء مهارة أساسية لأي شخص يكتب نصوص Shell. عندما لا يعمل النص كما هو متوقع، تساعدك هذه التقنيات على تحديد الأخطاء، وتتبع تنفيذ النص، وتحديد مكان حدوث المشكلة.

1. تشغيل نص في وضع تصحيح الأخطاء
الطريقة الأكثر فعالية لتصحيح أخطاء نص Shell هي تشغيله باستخدام العلامة -x. يؤدي ذلك إلى تشغيل وضع التتبع، الذي يطبع كل أمر وحججه على الجهاز قبل تنفيذه مباشرةً.

bash -x script.sh

ماذا يفعل: سيظهر في الإخراج رمز + يتبعه سطر الأوامر الذي يتم تنفيذه، بما في ذلك قيم أي متغيرات. يوفر هذا تتبعًا واضحًا وخطوة بخطوة لسير عمل النص الخاص بك.

مثال عملي:

COUNT=1
echo "Count is $COUNT"

إخراج تصحيح الأخطاء:

+ COUNT=1
+ echo 'Count is 1'
Count is 1

هذا يجعل من السهل رؤية تعيينات المتغيرات وتوسيعاتها فور حدوثها.

2. استخدام echo للتتبع
لتصحيح أخطاء أكثر تحديدًا أو استهدافًا، فإن إدخال عبارات echo في نصك هي تقنية بسيطة لكنها قوية.

echo "Reached here"

ماذا يفعل: يطبع أمر echo رسالة على وحدة التحكم. من خلال وضع هذه الرسائل بشكل استراتيجي، يمكنك تأكيد الأجزاء التي يتم تنفيذها من الشيفرة ومعرفة قيمة المتغير عند نقطة معينة.

مثال عملي:

#!/bin/bash
echo "Script started."

# Check if a file exists
if [ -f "my_file.txt" ]; then
  echo "File exists. Processing..."
  # ... further commands
else
  echo "File not found. Exiting."
  exit 1
fi

يساعدك هذا الأسلوب على تضييق نطاق المشكلة بسرعة من خلال إظهار المسار الشرطي الذي يتخذه النص.

3. تشغيل وإلغاء وضع تصحيح الأخطاء داخل النص
للمزيد من التحكم، يمكنك تشغيل وضع تصحيح الأخطاء لجزء محدد من النص بدلاً من الملف بأكمله.

تمكين تصحيح الأخطاء: أضف set -x قبل الجزء الذي تريد تصحيحه.

تعطيل تصحيح الأخطاء: أضف set +x بعد الجزء.

مثال عملي:

#!/bin/bash
# Regular script commands...

echo "Starting debug section for file processing."
set -x  # Turn on debug mode

# Debug this part
for file in *.log; do
  # ... commands
done

set +x  # Turn off debug mode
echo "Finished debug section."

تحافظ هذه الطريقة على نظافة إخراج النص الخاص بك من خلال إظهار التتبع فقط للأجزاء التي تقوم باستكشافها وإصلاحها بنشاط.

